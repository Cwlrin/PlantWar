<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
          name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        #main {
            width: 400px;
            height: 600px;
            background: url("./images/background_1.png");
            margin: 30px auto;
            position: relative;
        }
    </style>
</head>
<body>
<div id="main"></div>
<script>
    var mainObj = document.getElementById("main");
    var smallPlaneArray = [];

    /**
     *  创建敌方小飞机
     *  属性：图片节点、图片、x坐标、y坐标，速度
     *  行为：移动、初始化、把图片节点添加到 main 里面
     */
    function SmallPlaneProto(imgSrc, x, y, speed) {
        this.imgNode = document.createElement("img");
        this.imgSrc = imgSrc;
        this.x = x;
        this.y = y;
        this.speed = speed;
        this.init = function () {
            this.imgNode.src = this.imgSrc;
            this.imgNode.style.position = "absolute";
            this.imgNode.style.left = this.x + "px";
            this.imgNode.style.top = this.y + "px";
            mainObj.appendChild(this.imgNode);
        }
        this.init();
        this.move = function () {
            this.imgNode.style.top = parseInt(this.imgNode.style.top) + this.speed + "px";
        }
    }

    function createSmallPlane() {
        var smallPlane = new SmallPlaneProto("./images/enemy1_fly_1.png", parseInt(Math.random() * 356), -parseInt(Math.random() * 100 + 40), parseInt(Math.random() * 10));
        smallPlaneArray.push(smallPlane);
    }

    setInterval(createSmallPlane, 1000);

    function smallPlaneMove() {
        for (var i = 0; i < smallPlaneArray.length; i++) {
            smallPlaneArray[i].move();
            if (parseInt(smallPlaneArray[i].imgNode.style.top) >= 600) {
                mainObj.removeChild(smallPlaneArray[i].imgNode);
                smallPlaneArray.splice(i, 1);
            }
        }
    }

    setInterval(smallPlaneMove, 50);
</script>
</body>
</html>